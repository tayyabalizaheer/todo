<div class="blog-page-container">
  <div class="page-header">
    <div class="header-content">
      <div>
        <h1 class="page-title">Blog Posts</h1>
        <p class="page-subtitle">Create, manage, and publish your blog content</p>
      </div>
      <button class="btn-create" (click)="openCreateModal()">
        <mat-icon class="btn-icon">add</mat-icon>
        Create New Post
      </button>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="filters-section">
    <div class="search-box">
      <input 
        type="text" 
        [(ngModel)]="searchTerm"
        (input)="onSearchChange()"
        (keyup.enter)="onSearch()"
        placeholder="Search by title, excerpt, or content..."
        class="search-input"
      />
      <button (click)="onSearch()" class="btn-search">
        <mat-icon class="search-icon">search</mat-icon>
        Search
      </button>
    </div>

    <div class="filter-group">
      <label for="status-filter" class="filter-label">Status:</label>
      <select 
        id="status-filter"
        [(ngModel)]="statusFilter"
        (change)="onFilterChange()"
        class="filter-select"
      >
        <option value="all">All Status</option>
        <option value="published">Published</option>
        <option value="draft">Draft</option>
        <option value="archived">Archived</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="per-page-filter" class="filter-label">Show:</label>
      <select 
        id="per-page-filter"
        [(ngModel)]="perPage"
        (change)="onPerPageChange()"
        class="filter-select"
      >
        @for (option of perPageOptions; track option) {
          <option [value]="option">{{ option }}</option>
        }
      </select>
    </div>

    @if ((isLoading$ | async) === false) {
      <div class="results-info">
        <span class="results-count">
          {{ totalBlogs || 0 }} post{{ totalBlogs !== 1 ? 's' : '' }} found
        </span>
      </div>
    }
  </div>

  <!-- Error Message -->
  @if (error$ | async; as error) {
    <div class="error-banner">
      <mat-icon class="error-icon">warning</mat-icon>
      <p class="error-text">{{ error }}</p>
      <button class="error-close" (click)="dismissError()"><mat-icon>close</mat-icon></button>
    </div>
  }

  <!-- Blog List -->
  <app-blog-list 
    [blogs]="(blogs$ | async) || []"
    [loading]="(isLoading$ | async) || false"
    (blogSelected)="onBlogSelected($event)"
    (blogEdit)="onBlogEdit($event)"
    (blogDeleted)="onBlogDeleted($event)"
    (blogPublish)="onBlogPublish($event)"
    (blogUnpublish)="onBlogUnpublish($event)"
    (blogArchive)="onBlogArchive($event)"
  ></app-blog-list>

  <!-- Pagination -->
  @if ((isLoading$ | async) === false && totalPages > 1) {
    <div class="pagination">
      <button 
        class="pagination-btn pagination-nav"
        [disabled]="currentPage === 1"
        (click)="onPageChange(currentPage - 1)"
      >
        <span>←</span> Previous
      </button>

      <div class="pagination-numbers">
        @for (page of getPaginationArray(); track page) {
          <button 
            class="pagination-btn pagination-number"
            [class.active]="page === currentPage"
            (click)="onPageChange(page)"
          >
            {{ page }}
          </button>
        }
      </div>

      <button 
        class="pagination-btn pagination-nav"
        [disabled]="currentPage === totalPages"
        (click)="onPageChange(currentPage + 1)"
      >
        Next <span>→</span>
      </button>
    </div>
  }
</div>

<!-- Blog Modal -->
<app-blog-modal
  [isOpen]="isModalOpen"
  [blog]="selectedBlog"
  [isSubmitting]="isSubmitting"
  (close)="closeModal()"
  (submit)="onModalSubmit($event)"
></app-blog-modal>

