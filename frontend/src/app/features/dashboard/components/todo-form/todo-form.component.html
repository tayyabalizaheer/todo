<form [formGroup]="todoForm" (ngSubmit)="onSubmit()" class="todo-form">
  <div class="form-header">
    <h2>{{ isEditMode ? 'Edit Todo' : 'Create New Todo' }}</h2>
  </div>

  <div class="form-body">
    <!-- Title Field -->
    <div class="form-group">
      <label for="title" class="form-label">
        Title <span class="required">*</span>
      </label>
      <input
        type="text"
        id="title"
        formControlName="title"
        class="form-control"
        [class.error]="hasError('title', 'required') || hasError('title', 'minlength') || hasError('title', 'maxlength')"
        placeholder="Enter todo title"
        maxlength="255"
      />
      @if (getErrorMessage('title')) {
        <div class="error-message">{{ getErrorMessage('title') }}</div>
      }
      <div class="form-hint">
        {{ title?.value?.length || 0 }} / 255 characters
      </div>
    </div>

    <!-- Description Field -->
    <div class="form-group">
      <label for="description" class="form-label">
        Description
      </label>
      <textarea
        id="description"
        formControlName="description"
        class="form-control"
        [class.error]="hasError('description', 'maxlength')"
        placeholder="Enter todo description (optional)"
        rows="4"
        maxlength="1000"
      ></textarea>
      @if (getErrorMessage('description')) {
        <div class="error-message">{{ getErrorMessage('description') }}</div>
      }
      <div class="form-hint">
        {{ description?.value?.length || 0 }} / 1000 characters
      </div>
    </div>

    <!-- Due Date Field -->
    <div class="form-group">
      <label for="due_at" class="form-label">
        Due Date
      </label>
      <input
        type="date"
        id="due_at"
        formControlName="due_at"
        class="form-control"
        [min]="minDate"
      />
      <div class="form-hint">
        Select a due date for this todo (optional)
      </div>
    </div>
  </div>

  <div class="form-footer">
    <button
      type="button"
      (click)="onCancel()"
      class="btn btn-secondary"
      [disabled]="isSubmitting"
    >
      Cancel
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="isSubmitting || todoForm.invalid"
    >
      @if (isSubmitting) {
        <span class="spinner-small"></span>
        <span>{{ isEditMode ? 'Updating...' : 'Creating...' }}</span>
      } @else {
        <span>{{ isEditMode ? 'Update Todo' : 'Create Todo' }}</span>
      }
    </button>
  </div>
</form>
